<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; connect-src 'self'; img-src 'self' data:; font-src 'self' data:; worker-src 'self' blob:;">
    <title>优雅阅读器</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-message">加载中...</div>
        </div>
    </div>

    <div class="reader-container">
        <div class="reader-header">
            <h1 id="book-title">优雅阅读器</h1>
        </div>

        <div class="reader-main">
            <div class="reader-content" id="content">
                <p>请选择一个 TXT 文件开始阅读</p>
                <p style="color: #666; font-size: 14px;">提示：为获得最佳阅读体验，建议使用 UTF-8 编码的 TXT 文件</p>
                <p style="color: #666; font-size: 14px;">支持多种编码格式：UTF-8、GBK、Big5、Shift-JIS、EUC-KR、UTF-16等</p>
                <p style="color: #666; font-size: 14px;">提示：在主页和阅读页面可以分别调整字体大小</p>
            </div>

            <div class="reader-sidebar">
                <div class="setting-item" id="pick-file-btn">
                    <label for="file-input" class="setting-item">
                        <i class="icon">📂</i>
                        <span>选择</span>
                    </label>
                    <input type="file" id="file-input" accept=".txt" style="display: none;">
                </div>
                <div class="setting-item" id="random-book-btn">
                    <i class="icon">🎲</i>
                    <span>随机</span>
                </div>
                <div class="setting-item" id="toggle-chapters">
                    <i class="icon">≡</i>
                    <span>目录</span>
                </div>
                <div class="setting-item" id="toggle-theme">
                    <i class="icon">☾</i>
                    <span>夜间</span>
                </div>
                <div class="setting-item" id="toggle-font-panel">
                    <i class="icon">Aa</i>
                    <span>字体</span>
                </div>
                <div class="setting-item" id="font-size-up">
                    <i class="icon">A+</i>
                    <span>增大</span>
                </div>
                <div class="setting-item" id="font-size-down">
                    <i class="icon">A-</i>
                    <span>减小</span>
                </div>
                <div class="setting-item" id="go-home">
                    <i class="icon">⌂</i>
                    <span>主页</span>
                </div>
            </div>
        </div>

        <div class="reader-controls">
            <div class="progress-indicator">
                <div class="progress-bar">
                    <div class="progress-inner" id="progress-bar"></div>
                </div>
                <div class="progress-text">
                    <span id="progress-percentage">0%</span>
                </div>
            </div>
            <div class="navigation-buttons">
                <button id="prev-page">上一页</button>
                <span id="page-info">第 1 页</span>
                <button id="next-page">下一页</button>
            </div>
            <div class="reading-options">
                <label class="option-label">翻页方式:
                    <select id="page-turn-mode">
                        <option value="page">分页</option>
                        <option value="scroll">滚动</option>
                    </select>
                </label>
            </div>
        </div>
    </div>

    <div id="chapter-list" class="chapter-list hidden"></div>

    <div id="context-menu" class="context-menu" style="display: none;">
        <div class="context-menu-item" data-action="copy">复制选中文本</div>
        <div class="context-menu-item" data-action="translate">翻译选中文本</div>
        <div class="context-menu-item" data-action="search">搜索选中文本</div>
        <div class="context-menu-item" data-action="tts">朗读选中文本</div>
    </div>

    <div id="font-settings-panel" class="settings-panel hidden">
        <div class="settings-panel-header">
            <h3>字体设置</h3>
            <button class="close-btn" id="close-font-panel">×</button>
        </div>
        <div class="settings-panel-content">
            <div class="setting-group">
                <label>字体：</label>
                <select id="font-family-selector">
                    <option value="'Microsoft YaHei', 'PingFang SC', sans-serif">微软雅黑</option>
                    <option value="'SimSun', serif">宋体</option>
                    <option value="'KaiTi', serif">楷体</option>
                    <option value="'FangSong', serif">仿宋</option>
                    <option value="'STXihei', sans-serif">华文细黑</option>
                    <option value="'Source Han Sans CN', sans-serif">思源黑体</option>
                </select>
            </div>
            <div class="setting-group">
                <label>行高：</label>
                <input type="range" id="line-height-slider" min="1.2" max="2.5" step="0.1" value="1.8">
                <span id="line-height-value">1.8</span>
            </div>
            <div class="setting-group">
                <label>字间距：</label>
                <input type="range" id="letter-spacing-slider" min="0" max="0.15" step="0.01" value="0">
                <span id="letter-spacing-value">0</span>
            </div>
            <div class="setting-group">
                <label>段落间距：</label>
                <input type="range" id="paragraph-spacing-slider" min="0.6" max="2" step="0.1" value="0.8">
                <span id="paragraph-spacing-value">0.8em</span>
            </div>
        </div>
    </div>

    <script type="module" src="./renderer/index.js"></script>
</body>
</html>
